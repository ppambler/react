### âœï¸ Tangxt â³ 2021-02-12 ğŸ·ï¸ lifecycle

# 09-React ç”Ÿå‘½å‘¨æœŸ

> ä»æ‘‡ç¯®åˆ°åŸå¢“ -> ç»„ä»¶ä»è¯ç”Ÿåˆ°æˆé•¿å†åˆ°æ¶ˆäº¡ï¼Œè¿™ä¸€è¿‡ç¨‹å‘ç”Ÿäº†ä¸€äº›äº‹å„¿ï¼Œè€Œè¿™äº›ä¸€ä»¶ä»¶çš„äº‹å„¿éƒ½ä¼šè§¦å‘ä¸€ä¸ªä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼

å“åº”ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæœ‰ä¸‰ç§ç±»å‹ï¼šæŒ‚è½½ï¼ˆMountingï¼‰ã€æ›´æ–°ï¼ˆUpdating ï¼‰å’Œå¸è½½ï¼ˆUnmountingï¼‰

## â˜…è¯¾ä»¶

- æ–‡æ¡£ï¼š<https://reactjs.org/docs/state-and-lifecycle.html>
- ä¸­æ–‡æ–‡æ¡£ï¼š <https://react.docschina.org/docs/state-and-lifecycle.html>

1. æœ‰å“ªäº›ç”Ÿå‘½å‘¨æœŸ
2. æ¯ä¸ªå‘¨æœŸæœ‰ä»€ä¹ˆç‰¹ç‚¹

div çš„ä¾‹å­ï¼š<https://codesandbox.io/s/54mkyvl3r4>

React çš„ä¾‹å­ï¼š<https://codesandbox.io/s/yqrkxpm01>

å›¾ç¤ºï¼š<https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/>

## â˜…React çš„ç”Ÿå‘½å‘¨æœŸ

é¢è¯•å¿…è€ƒï¼Œä½†å¹³æ—¶ç”¨å¾—ä¸å¤šã€‚å¹³æ—¶ç”¨åˆ°å®ƒçš„çŸ¥è¯†ç‚¹éå¸¸å°‘ï¼Œä½†é¢è¯•çš„æ—¶å€™é—®åˆ°å®ƒçš„çŸ¥è¯†ç‚¹å°±ç‰¹åˆ«å¾—å¤šï¼

### <mark>1ï¼‰å¦‚ä½•è®² React çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ</mark>

å®˜ç½‘è®²ç”Ÿå‘½å‘¨æœŸè¿™ä¸€ç« èŠ‚çš„æ ‡é¢˜æ˜¯ã€ŒState and Lifecycleã€

State æˆ‘ä»¬å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œä½†æ˜¯ Lifecycle æ˜¯ä»€ä¹ˆç©æ„å„¿å‘¢ï¼Ÿï¼ˆä¸çŸ¥é“ï¼‰

è¦è®²æ¸…æ¥šç”Ÿå‘½å‘¨æœŸï¼Œé‚£ä¸€å¼€å§‹å°±ä¸è®² Reactï¼Œä¸ç„¶ï¼ŒæŠŠç”Ÿå‘½å‘¨æœŸé…åˆ React æ¥è®²çš„è¯ï¼Œç”Ÿå‘½å‘¨æœŸå°±ç‰¹åˆ«çš„æ¨¡ç³Šäº†ã€‚

æ€»ä¹‹ï¼Œä¸è®² Reactï¼Œç›´æ¥è®²ç”Ÿå‘½å‘¨æœŸï¼Œå°±ä¸æ¨¡ç³Šäº†ã€‚

### <mark>2ï¼‰åŸç”Ÿ JS vs ç”Ÿå‘½å‘¨æœŸ</mark>

![ç”Ÿå‘½å‘¨æœŸ](assets/img/2021-02-12-18-12-51.png)

æˆ‘ä»¬ç ”ç©¶ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡å°±æ˜¯`div` -> çœ‹çœ‹å®ƒçš„ç”Ÿè€ç—…æ­»æ˜¯æ€æ ·çš„â€¦â€¦

ğŸ’¡ï¼š`create` å’Œ `mount`çš„åŒºåˆ«ï¼Ÿ

![create vs mount](assets/img/2021-02-13-16-30-20.png)

æˆ‘ä»¬åˆ›é€ çš„`div`æ²¡æœ‰åœ¨é¡µé¢é‡Œè¾¹ï¼Œåªæ˜¯å‡ºç°åœ¨ JS å†…å­˜ä¸­ï¼

è€Œæˆ‘ä»¬æŠŠ`div`æ”¾åˆ°`app`é‡Œè¾¹ï¼Œè¿™å°±å«åš`mount` -> æŠŠ`div` `mount`åˆ°`app`é‡Œè¾¹ï¼

æŠŠä¸€ä¸ªä¸œè¥¿æ”¾åˆ°å¦ä¸€ä¸ªä¸œè¥¿é‡Œè¾¹ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åšã€ŒæŒ‚è½½ã€ï¼

ğŸ’¡ï¼šReact é‡Œè¾¹æœ‰ `props`ï¼Œè¿™ä¸ªåŸç”Ÿä¾‹å­ä¸è®²`props`â€¦â€¦

ğŸ’¡ï¼šå…ˆå¡«å……ï¼Œå†æŒ‚è½½ï¼Ÿ

![mount å‰å¡«å……](assets/img/2021-02-13-16-36-57.png)

ğŸ’¡ï¼šæ›´æ–°`div`ï¼Ÿ

``` js
div.querySelector('button').onclick = () => {
  state += 1
  // update div
  div.querySelector('p').innerText = state
}
```

ğŸ’¡ï¼šReact ç”Ÿå‘½å‘¨æœŸæœ€é‡è¦çš„ä¸‰ä¸ªç‚¹ï¼Ÿ

1. å‡ºç°åœ¨å†…å­˜é‡Œè¾¹
2. å‡ºç°åœ¨é¡µé¢é‡Œè¾¹ï¼Œå‡ºç°åœ¨é¡µé¢é‡Œè¾¹ä¹‹å‰ï¼Œæœ€å¥½å…ˆæŠŠå­å…ƒç´ å‡†å¤‡å¥½
3. æ›´æ–°å†…å®¹ï¼ŒæŠŠæŸéƒ¨åˆ†å†…å®¹ç»™æ›´æ–°äº†

ğŸ’¡ï¼šå…³äº`div`çš„æ­»äº¡ï¼Ÿ

`div.remove`ï¼Ÿ -> è¿™æ˜¯`div`çš„è‡ªæ¯ç¨‹åºï¼ŒæŠŠè‡ªå·±ä»é¡µé¢é‡Œè¾¹ç§»é™¤ï¼

ä½†æ˜¯ï¼Œä½ è¿˜å¾—ç§»é™¤ä¸€äº›ç»‘å®šåœ¨`div`èº«ä¸Šçš„äº‹ä»¶ç›‘å¬ï¼Œè¿˜æœ‰`div`è‡ªå·±æ‰€å çš„å†…å­˜ï¼

``` js
div.querySelectorAll("button")[1].onclick = () => {
  div.querySelector("button").onclick = null;
  div.querySelectorAll("button")[1].onclick = null;
  div.remove();
  div = null; // destroy div
};
```

ğŸ’¡ï¼šäººæœ‰ç”Ÿè€ç—…æ­»ï¼Œ`div`æœ‰ç”ŸæŒ‚æ›´æ–°æ­»â€¦â€¦

### <mark>2ï¼‰React çš„ç”Ÿå‘½å‘¨æœŸ</mark>

![ç”Ÿå‘½å‘¨æœŸ](assets/img/2021-02-13-16-58-12.png)

> å›¾æ¥æºï¼š[React ç”Ÿå‘½å‘¨æœŸçš„å›¾è§£ - ç®€ä¹¦](https://www.jianshu.com/p/46022f1cbbb3)

> æ–¹æ–¹è¯´å‡½æ•°æ˜¯æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„ï¼`class`ç»„ä»¶æ‰æœ‰ç”Ÿè€ç—…æ­»ï¼

ğŸ’¡ï¼šç¬¬ä¸€è½®ï¼ŒæŒ‚è½½é˜¶æ®µï¼Ÿ

![mounting](assets/img/2021-02-13-17-16-14.png)

ğŸ’¡ï¼šç»™ç”¨æˆ·ä¸€ä¸ªç‚¹é¡µé¢çš„æœºä¼šï¼Œå¥½è®©ç”¨æˆ·å¯ä»¥æ›´æ–°ç»„ä»¶ï¼Ÿ

> èƒ½åœ¨`componentDidMount`å‰ç‚¹å‡»é¡µé¢å—ï¼Ÿä¸èƒ½ï¼

ğŸ’¡ï¼šè‡ªå·±åšä¸€ä¸ªæ§åˆ¶å°ï¼Œè®©æ§åˆ¶å°çš„å†…å®¹åœ¨é¡µé¢ä¸­æ˜¾ç¤ºï¼Ÿ

``` js
let div = document.createElement('div')
document.body.appendChild(div)

console.log = function(content) {
  div.innerHTML += `${content}<br>`
}
```

ğŸ’¡ï¼šä¸ºå•¥è¦åœ¨åˆ›å»ºçš„æ—¶å€™åˆå§‹åŒ–çŠ¶æ€ï¼Ÿ

åˆå§‹åŒ–å¾—è¶Šæ—©è¶Šå¥½ï¼è€Œæœ€æ—©çš„æ—¶é—´å°±æ˜¯å‡ºç”Ÿçš„é‚£å¤©â€¦â€¦å­©å­ä¸€å‡ºç”Ÿï¼Œåˆå§‹åŒ–äº† ta çš„çˆ¸çˆ¸å¦ˆå¦ˆâ€¦â€¦

æ€»ä¹‹ï¼Œç»„ä»¶ä¸€å‡ºç”Ÿå°±ç»™å®ƒä¸€ä¸ª`state`

![ç»™ä¸€ä¸ª state](assets/img/2021-02-13-17-32-42.png)

ğŸ’¡ï¼šç›®å‰çš„ä»£ç ï¼Ÿ

``` jsx
let div = document.createElement("div");
document.body.appendChild(div);

console.log = function (content) {
  div.innerHTML += `${content}<br>`;
};

class App extends React.Component {
  add1() {
    console.log("ç”¨æˆ·ç‚¹å‡»äº†");
    this.setState({
      n: this.state.n + 1,
      flag: true
    });
  }
  constructor() {
    super();
    this.state = {
      n: 0,
      flag: false
    };
    console.log("åˆ›å»º App");
  }
  componentWillMount() {
    console.log("å°†è¦ mount App");
  }
  render() {
    console.log(`${this.state.flag ? 'æ›´æ–°' : 'å¡«å……'} App çš„å†…å®¹`);
    return (
      <div className="app">
        {this.state.n}
        <button
          onClick={() => {
            this.add1();
          }}
        >+1</button>
      </div>
    );
  }
  componentDidMount() {
    console.log("mount App å®Œæ¯•");
  }
}

ReactDOM.render(<App />, document.getElementById("root"));
```

æ•ˆæœï¼š

![æ•ˆæœ](assets/img/2021-02-13-17-43-05.png)

`render`å°±æ˜¯åœ¨`update`ï¼Œç¬¬ä¸€æ¬¡å¡«å……ï¼ˆå…¶å®ä¹Ÿå«æ›´æ–°ï¼‰ï¼Œåœ¨`render`ï¼Œç¬¬äºŒæ¬¡æ›´æ–°ï¼Œä¹Ÿæ˜¯`render`ã€‚

ğŸ’¡ï¼šæˆ‘èƒ½å¦åœ¨æ›´æ–°`App`çš„å†…å®¹ä¹‹å‰åšç‚¹äº‹æƒ…å‘¢ï¼Ÿ

React æä¾›äº†ä¸€ä¸ªå«`componentWillUpdate`çš„é’©å­ï¼Œè€Œä¸”æ›´æ–°ä¹‹åä¹Ÿæä¾›äº†ä¸€ä¸ªå«`componentDidUpdate`çš„é’©å­ï¼š

![é’©å­](assets/img/2021-02-13-21-07-39.png)

ğŸ’¡ï¼šç¬¬ä¸€æ¬¡çš„ï¼Œé’©å­éƒ½å¸¦æœ‰ mountï¼Œç¬¬äºŒæ¬¡çš„ï¼Œé’©å­éƒ½å¸¦æœ‰æ›´æ–°

ğŸ’¡ï¼šå¦‚æœç»„ä»¶è¦æ­»äº†ï¼Ÿ

å¦‚ä½•è®©ç»„ä»¶å‡‰å‡‰ï¼Ÿ

1. è·¯ç”±åˆ‡æ¢
2. çˆ¸çˆ¸ç»„ä»¶è®©å®ƒå‡‰å‡‰

è¯è¯´ï¼Œå„¿å­è¢«å‡‰å‡‰ä¹‹å‰ï¼Œèƒ½å¦è¯´ä¸€å¥é—è¨€å‘¢ï¼Ÿ

å¯ä»¥ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°`componentWillUnmount`è¿™ä¸ªé’©å­äº†ï¼Œè¡¨ç¤ºå„¿å­é©¬ä¸Šä»é¡µé¢ä¸­è¢«å¼„å‡ºæ¥ï¼

![componentWillUnmount](assets/img/2021-02-13-21-43-25.png)

ğŸ’¡ï¼šçˆ¸çˆ¸ç»™å„¿å­ä¼ æ–°çš„æ•°æ®ï¼Ÿ

å¦‚ä½•çŸ¥é“çˆ¸çˆ¸ä¼ æ•°æ®ç»™å„¿å­ï¼Ÿ -> ä½¿ç”¨`componentWillReceiveProps(nextProps)`è¿™ä¸ªé’©å­ï¼

![componentWillReceiveProps](assets/img/2021-02-13-21-49-52.png)

---

æ¥ä¸‹æ¥å°±è®²ä¸€ä¸‹è¿™ 8 ä¸ªç”Ÿå‘½å‘¨æœŸåˆ†åˆ«å¦‚ä½•åœ°ä½¿ç”¨â€¦â€¦

![ç”Ÿå‘½å‘¨æœŸ](assets/img/2021-02-13-21-55-31.png)

17 ç‰ˆåï¼Œä¸€äº›é’©å­è¢«åºŸå¼ƒäº†ï¼š

- componentWillMount() -> UNSAFE_componentWillMount()
- componentWillReceiveProps(nextProps) -> UNSAFE_componentWillReceiveProps()
- componentWillUpdateï¼ˆnextProps, nextState) -> UNSAFE_componentWillUpdate()

## â˜…è¿™äº›ç”Ÿå‘½å‘¨æœŸçš„åŒºåˆ«

> å¦‚ä½•ä½¿ç”¨å„ä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿ

### <mark>1ï¼‰æˆ‘ä»¬åœ¨é¡µé¢é‡Œè¾¹ä¸€èˆ¬è¦åšçš„åŠ¨ä½œæœ‰å“ªäº›ï¼Ÿ</mark>

ä¸€èˆ¬ React åšçš„å°±è¿™ä¸¤ä¸ªï¼š

1. å‘è¯·æ±‚ï¼Œè¯·æ±‚æ•°æ®ï¼ˆajaxï¼‰
2. æ›´æ–°çŠ¶æ€ï¼Œå³æ›´æ–°æ•°ï¼ˆsetStateï¼‰

å¦‚æœéè¦å¼ºåŠ çš„è¯ï¼Œè¿™ä¸¤ä¸ªä¹Ÿç®—ï¼š

3. äº‹ä»¶ç›‘å¬ï¼ˆonClickï¼‰
4. åˆå§‹åŒ– state

ğŸ’¡ï¼šè¯·æ±‚æ•°æ®æ”¾å“ªå„¿åšï¼Ÿ

ç†è®ºä¸Šè¿™ 8 ä¸ªé’©å­éƒ½è¡Œ -> ä¸ºä»€ä¹ˆéƒ½è¡Œï¼Ÿ -> å› ä¸ºè¯·æ±‚æ•°æ®æ›´æ–°è·Ÿç»„ä»¶å…³ç³»å¹¶ä¸å¤§ï¼

è¯·æ±‚æ•°æ®çš„åŸåˆ™ï¼šè¶Šæ—©è¶Šå¥½ï¼

è¯·æ±‚æ•°æ®æœ‰ä¸¤ä¸ªæ¯”è¾ƒå¥½çš„æ—¶æœºï¼š

1. åˆ›å»º App -> `constructor`
2. äº‹ä»¶å¤„ç†å‡½æ•° -> `onClick`ï¼ˆæœ‰äº›è¯·æ±‚å¿…é¡»ç­‰ç”¨æˆ·æŸä¸ªåŠ¨ä½œä¹‹åæ‰å»è¯·æ±‚ï¼‰

å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥åœ¨`componentWillMount`ã€`render`é‡Œè¾¹å‘ï¼Œä¸è¿‡`render`æŒ‰è§„èŒƒæ˜¯çº¯å‡½æ•°ï¼Œæ‰€ä»¥`render`å°±ç®—äº†ï¼

å‡ ä¹åŒæ—¶æ‰§è¡Œï¼Ÿ

![åŒæ—¶æ‰§è¡Œ](assets/img/2021-02-13-22-49-20.png)

è‡³äºï¼Œå…¶å®ƒåˆšåˆšè®²åˆ°çš„å‰©ä½™é’©å­ï¼Œéƒ½å¯ä»¥å‘é€è¯·æ±‚ï¼Œæ³¨æ„ï¼Œ**è¿™é‡Œå¼ºè°ƒçš„ä»…ä»…æ˜¯å‘è¯·æ±‚è¿™ä»¶äº‹â€¦â€¦**

æ€»ä¹‹ï¼Œè¦ä¹ˆåœ¨`constructor`å‘ï¼Œè¦ä¹ˆåœ¨äº‹ä»¶å¤„ç†å‡½æ•°`onClick`é‡Œè¾¹å‘ï¼ -> **è¶Šæ—©å‘è¶Šå¥½ï¼**

### <mark>2ï¼‰ä»€ä¹ˆæ—¶å€™åˆå§‹åŒ–`state`ï¼Ÿ</mark>

ğŸ’¡ï¼š`state`æ˜¯ä»€ä¹ˆæ—¶å€™äº§ç”Ÿçš„ï¼Ÿ

`state`è·Ÿç»„ä»¶ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œ`state`å®ƒæ˜¯ç»„ä»¶çš„ä¸€ä¸ªé™„å±å“

åœ¨`render`å‰éƒ½é‚£äº›é’©å­éƒ½å¯ä»¥åˆå§‹åŒ–`state`ï¼Œä½†æ˜¯å®˜æ–¹æ¨èä½ åœ¨`constructor`é‡Œè¾¹åˆå§‹åŒ–â€¦â€¦

ä½•ä»¥è§å¾—ï¼Ÿ

![state åˆå§‹åŒ–ä½ç½®](assets/img/2021-02-13-23-04-09.png)

### <mark>3ï¼‰æ›´æ–°`state`æ”¾å“ªå„¿ï¼Ÿ</mark>

æœ€æ˜æ˜¾çš„åœ°æ–¹ï¼Œäº‹ä»¶å¤„ç†å‡½æ•° -> `onClick`

è¯è¯´ï¼Œæˆ‘ä»¬èƒ½å¦åœ¨å…¶å®ƒé’©å­é‡Œè¾¹æ›´æ–°å‘¢ï¼Ÿ

å¦‚`constructor`

ä¼šæŠ¥é”™ï¼šå‘Šè¯‰ä½ ä¸èƒ½åœ¨`mount`ä¹‹å‰æ›´æ”¹çŠ¶æ€

è¿˜æœ‰ä¸èƒ½åœ¨`render`é‡Œè¾¹æ›´æ”¹çŠ¶æ€ï¼Œä¸ç„¶ä¼šæ­»å¾ªç¯ï¼Œå¯¼è‡´çˆ†æ ˆï¼

åœ¨`componentDidMount`é‡Œè¾¹`setState` -> è¿™ä¸ª`setState`åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå› ä¸ºç»„ä»¶åªä¼š`mount`ä¸€æ¬¡ã€‚

`componentWillUpdate` -> è¿™ä¼šæ­»å¾ªç¯ï¼Œçˆ†æ ˆâ€¦â€¦å› ä¸ºç»„ä»¶ä¹‹æ‰€ä»¥æ›´æ–°æ˜¯å› ä¸º`state`å˜äº†ï¼Œæ‰€ä»¥ä½ ä¸èƒ½åœ¨è¿™ä¸ªé’©å­é‡Œè¾¹`setState`

åŒç†ï¼Œ`componentDidUpdate`ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¹Ÿä¼šæ­»å¾ªç¯ï¼

`componentWillUnmount` -> å’©æœ‰æ„ä¹‰ï¼Œå°±åƒæ˜¯ä¸´æ­»å‰èµšä¸€å—é’±èŠ±è¿™æ ·æ²¡å•¥æ„ä¹‰â€¦â€¦æ³¨æ„ï¼Œä½ è¿˜æœ‰ 1s å°±å‡‰å‡‰äº†ï¼ˆä»€ä¹ˆä¹Ÿåšä¸äº†ï¼‰ï¼Œå¯ä¸æ˜¯è¿˜æœ‰ä¸€å¤©å•Šï¼æ€»ä¹‹ï¼Œä½ ä¸èƒ½æƒ³ç€ä¸´æ­»å‰æ‰“ä¸€å±€ LOL è¿™æ ·â€¦â€¦ -> ç®€å•å†™ä¸€å°é—ä¹¦ï¼Œæˆ–è¯´ä¸€å¥è¯å°±å¤Ÿäº†ï¼åƒä¸‡ä¸è¦åšä»»ä½•æ›´æ–°è‡ªå·±çš„äº‹å„¿ï¼

`componentWillReceiveProps` -> è¿™ä¸ªå¯ä»¥`setState`ï¼Œå®ƒå¯ä»¥è®°å½•ã€Œçˆ¸çˆ¸è¯´äº†å‡ æ¬¡è¯ã€â€¦â€¦ -> **ç”¨å¾—æ¯”è¾ƒå¤š**

æ€»ä¹‹ï¼Œæœ‰å¸¸ç”¨çš„ 3 å¤„åœ°æ–¹å¯ä»¥æ”¾`setState`ï¼š

1. äº‹ä»¶å¤„ç†å‡½æ•°
2. `componentDidMount`
3. `componentWillReceiveProps`

æ–¹æ–¹æ˜¯å¦‚ä½•å¾—å‡ºè¿™å‡ ç‚¹çš„ï¼Ÿ -> å¾ˆç®€å•ï¼Œä¸€ä¸ªä¸ªæ’æŸ¥å‡ºæ¥çš„ï¼æœ‰é€»è¾‘é”™è¯¯çš„å°±ä¸èƒ½æ”¾ï¼

### <mark>4ï¼‰äº‹ä»¶ç›‘å¬æ”¾å“ªå„¿ï¼Ÿ</mark>

ä¸€èˆ¬éƒ½æ”¾åœ¨å…ƒç´ æ ‡ç­¾ä¸Šå•Šï¼é™¤æ­¤ä¹‹å¤–å°±æ²¡åœ°æ–¹äº†ï¼ 

æ³¨æ„ï¼Œä¹Ÿä¸è¦ç”¨åŸç”Ÿçš„ JS åšäº‹ä»¶ç›‘å¬ï¼

### <mark>5ï¼‰é˜»æ­¢ç»„ä»¶æ›´æ–°ï¼Ÿ</mark>

`shouldComponentUpdate(nextProps, nextState)`

è®©è¿™ä¸ªé’©å­è¿”å›`false`å€¼ï¼Œè¿™æ ·ä¸ç®¡ä½ å¦‚ä½•`setState`éƒ½ä¸ä¼šæ›´æ–°ç»„ä»¶ï¼

ä¸€äº›æµ‹è¯•ä¾‹å­ï¼š

å¶æ•°æ›´æ–°ï¼š

![å¶æ•°æ›´æ–°](assets/img/2021-02-13-23-39-18.png)

åˆå§‹å€¼æ˜¯`0`ï¼Œç”¨æˆ·ç‚¹å‡»äº†ï¼Œæ­¤æ—¶å°†è¦æ›´æ–°ä¸º`1`ï¼Œé‚£å°±ä¸æ›´æ–°å‘—ï¼ï¼ˆæ³¨æ„è¿™æ˜¯é¡µé¢å’©æœ‰ä»»ä½•å˜åŒ–ï¼Œä½†æ˜¯å†…å­˜ä¸­çš„çŠ¶æ€å·²ç»å˜æˆ`1`äº†ï¼‰ï¼Œç”¨æˆ·å†ç‚¹å‡»ï¼Œæ­¤æ—¶å°†è¦æ›´æ–°ä¸º`2`ï¼Œé‚£å°±æ›´æ–°é¡µé¢å‘—ï¼

é¿å…ä¸å¿…è¦çš„æ›´æ–°ï¼š

æˆ‘ä»¬å†™äº†ä¸€ä¸ªä¸å‡ºç°åœ¨é¡µé¢é‡Œè¾¹çš„`x`çŠ¶æ€ï¼Œæˆ‘ä»¬æ›´æ–°äº†è¿™ä¸ª`x`ï¼Œæ˜¾ç„¶è¿™å°±éœ€è¦å»`render`äº†ï¼Œå¯æ˜¯é¡µé¢ç”¨åˆ°çš„çŠ¶æ€å¹¶å’©æœ‰å‘ç”Ÿæ”¹å˜å•Šï¼æ‰€ä»¥æˆ‘ä»¬æ˜¾ç„¶å¹¶ä¸éœ€è¦å»æ›´æ–°â€¦â€¦

![æ›´æ–°](assets/img/2021-02-13-23-51-30.png)

è¿™ä¸ªé’©å­ä¸€èˆ¬ä¸ç”¨ï¼Œä¸€èˆ¬éƒ½ç”¨åœ¨éå¸¸ç‰¹æ®Šçš„æƒ…å†µï¼

é¢è¯•é¢˜ï¼š

![é¢è¯•é¢˜](assets/img/2021-02-13-23-53-10.png)

â¹ï¼š[React å¸¸ç”¨é¢è¯•é¢˜ç›®ä¸åˆ†æ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/24856035)

å¦‚æœé—®ä½ ä¾‹å­ï¼Œé‚£å°±è¯´ä¸Šè¾¹çš„ä¾‹å­ï¼Œå³ï¼šä¸€ä¸ªä¸æ˜¾ç¤ºåœ¨ UI ä¸Šçš„çŠ¶æ€å˜äº†ï¼Œå°±å¾—åˆ¤æ–­ä¸€ä¸‹æ˜¾ç¤ºåœ¨ UI ä¸Šçš„çŠ¶æ€æ˜¯å¦å˜äº†ï¼Œå¦‚æœå˜äº†ï¼Œé‚£å°±è¿”å›`true`ï¼Œ`render`ç»„ä»¶ï¼Œå¦åˆ™å°±`false`ï¼Œä¸æ›´æ–°ï¼

## â˜…é¢è¯•å¸¸è€ƒçš„ç‚¹

[å…³äº React é¢è¯•é¢˜æ±‡æ€»](https://juejin.cn/post/6844903620664623111#comment):

1. è¯·è¯´ä¸€ä¸‹ React ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›å‡½æ•°ï¼Ÿ
2. React æ€§èƒ½ä¼˜åŒ–æ˜¯å“ªä¸ªå‘¨æœŸå‡½æ•°ï¼Ÿ

åœ¨é¢è¯• React å‰ï¼Œå°±æŠŠ React çš„ç›¸å…³é¢è¯•é¢˜è¿‡ä¸€éå°±å¥½äº†ï¼

[React å¸¸ç”¨é¢è¯•é¢˜ç›®ä¸åˆ†æ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/24856035)ï¼š

1. åœ¨ç”Ÿå‘½å‘¨æœŸä¸­çš„å“ªä¸€æ­¥ä½ åº”è¯¥å‘èµ· AJAX è¯·æ±‚ï¼Ÿ -> æ–¹æ–¹ä¸è®¤åŒä»–æ˜¯å¯¹çš„ï¼Œä½†ä»–ç»™å‡ºæ¥ç†ç”±ï¼Œæ‰€ä»¥ä¸ªä¿¡ä¸ä¿¡ç”±ä½ ï¼ -> é¢è¯•ç»Ÿä¸€è¯´æ˜¯`componentDidMount`ï¼ˆæ–¹æ–¹ä¸æ˜¯å¾ˆè®¤åŒï¼‰ï¼Œè¿™æ˜¯çœ‹äº†å‡ ä¸ªé¢è¯•é¢˜å½’çº³åšå®¢å¾—å‡ºæ¥çš„è¯´æ³• -> ä¸èƒ½æ”¾åœ¨`constructor`é‡Œè¾¹æ˜¯å› ä¸ºä½ ä¸èƒ½åœ¨è¿™å„¿`setState`ï¼Œè€Œä¸èƒ½æ”¾åœ¨`componentWillMount`æ˜¯ä¸ºäº†æ€§èƒ½çš„éœ€è¦ï¼Œå› ä¸ºç”¨äº† fiberï¼ -> è¿™æ˜¯ç”¨äº†æ’é™¤æ³•ï¼Œæ ¹æ®è¯·æ±‚è¶Šæ—©è¶Šå¥½ï¼ŒæŠŠæœ€æ—©çš„é€æ­¥æ’é™¤ï¼Œé‚£ä¹ˆæœ€ç»ˆæ— æ³•æ’é™¤çš„å°±æ˜¯æ­£ç¡®çš„ç­”æ¡ˆäº†ï¼
2. å½“è°ƒç”¨`setState`ä¹‹åï¼Œç»„ä»¶ä¼šè°ƒç”¨å“ªå‡ ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Ÿ -> shouldComponentUpdate -> componentWillUpdate -> render -> componentDidUpdate

çœ‹ç€é¢è¯•é¢˜ä¸æ–­åœ°æµ‹è¯•å°±å¥½äº†ï¼èƒŒä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™æ ·åšçš„åŸå› å°±è¡Œäº†ï¼

â¹ï¼š[å…³äº React çš„å‡ é“é¢è¯•é¢˜ - Kevin's Notes](https://wuxinhua.com/2018/03/17/The-questions-about-react-and-redux-in-interview/)

æ€»ç»“ä¸€ä¸‹é¢è¯•é¢˜ï¼š

1. è¯·è¯´ä¸€ä¸‹ React é‡Œè¾¹æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Ÿï¼ˆ9 ä¸ªï¼‰
2. è¯·è¯´ä¸€ä¸‹ `shouldComponentUpdate` ä¸ºä»€ä¹ˆé‚£ä¹ˆé‡è¦ï¼Ÿ
   1. å®ƒå¯ä»¥è‡ªå®šä¹‰æ˜¯å¦æ›´æ–°ç»„ä»¶
   2. æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥ä¼˜åŒ–è¿™ä¸ªæ›´æ–°æ•ˆç‡
3. è¯·é—® ajax è¯·æ±‚ï¼Œåº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°é‡Œè¾¹å‘å‡ºï¼Ÿ
   1. `componentDidMount`
   2. åŸå› ï¼š
      1. `constructor`é‡Œè¾¹ä¸èƒ½ä½¿ç”¨`setState`ï¼ˆæ–¹æ–¹è¡¨ç¤ºä¸æˆç«‹ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºç»„ä»¶è¦ç”¨åˆ°è¯·æ±‚è¿‡æ¥çš„æ•°æ®å§ï¼Œä¸è¿‡ï¼Œè¿™çœŸå¾—æ˜¯å¼ºåˆ¶æ€§çš„å—ï¼Ÿï¼‰
      2. å› ä¸º`componentWillMount`åœ¨ fiber é‡Œè¾¹ä¼šå¤šæ¬¡è¢«è°ƒç”¨ï¼Œé€ æˆä¸ç¨³å®šï¼ï¼ˆé“å¬é€”è¯´ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå³ä¾¿æ·±é—®èµ·æ¥ï¼Œé¢è¯•å®˜ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ fiber ä¼šé€ æˆä¸ç¨³å®šï¼‰
      3. `render` -> ä¿è¯æ˜¯çº¯å‡½æ•°ï¼Œæ‰€ä»¥æœ€åå°±è‡ªç„¶è€Œç„¶åœ°è½åˆ°äº†`componentDidMount`è¿™ä¸ªé’©å­é‡Œè¾¹äº†ï¼
4. è°ƒç”¨`setState`çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨å“ªå‡ ä¸ªé’©å­ï¼Ÿ
   1. å››ä¸ªï¼š`shouldComponentUpdate -> componentWillUpdate -> render -> componentDidUpdate`ï¼ˆå…¶å®å°±æ˜¯ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯çœ‹è¦ä¸è¦æ›´æ–°ï¼Œå¦ä¸€ä¸ªå°±æ˜¯æ›´æ–°ï¼Œæ›´æ–°åˆæœ‰ä¹‹å‰å’Œä¹‹åï¼‰

## â˜…äº†è§£æ›´å¤š

â¹ï¼š[React å…¥é—¨å®ä¾‹æ•™ç¨‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—](https://www.ruanyifeng.com/blog/2015/03/react.html)

â¹ï¼š[React ç”Ÿå‘½å‘¨æœŸ - WindrunnerMax - åšå®¢å›­](https://www.cnblogs.com/WindrunnerMax/p/14090262.html)

â¹ï¼š[å¤§è¯ react ç”Ÿå‘½å‘¨æœŸ 2019ï¼šreact-v16.3 æ–°ç”Ÿå‘½å‘¨æœŸæ€»ç»“ - SegmentFault æ€å¦ï¼ˆâ˜…ï¼‰](https://segmentfault.com/a/1190000020348448)

â¹ï¼š[å›¾è§£ ES6 ä¸­çš„ React ç”Ÿå‘½å‘¨æœŸ](https://juejin.cn/post/6844903510538977287#heading-15)

â¹ï¼š[React ç”Ÿå‘½å‘¨æœŸè¯¦è§£ - SegmentFault æ€å¦](https://segmentfault.com/a/1190000021827650)

â¹ï¼š[ï¼ˆâ˜…ï¼‰è¯‘-React ç”Ÿå‘½å‘¨æœŸæ–¹æ³•--æ·±å…¥ç†è§£ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/349661581)

â¹ï¼š[ç”Ÿå‘½å‘¨æœŸ - çŸ¥ä¹](https://www.zhihu.com/topic/19601187/hot)

â¹ï¼š[React Lifecycle Methods - A Deep Dive - Programming with Mosh](https://programmingwithmosh.com/javascript/react-lifecycle-methods/)

â¹ï¼š[é™„å®ä¾‹ï¼å›¾è§£ React çš„ç”Ÿå‘½å‘¨æœŸåŠæ‰§è¡Œé¡ºåº_Mathilda91 çš„åšå®¢-CSDN åšå®¢](https://blog.csdn.net/weixin_33767813/article/details/88598680)

â¹ï¼š[ç”Ÿå‘½å‘¨æœŸ-React ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾åŠç®€è¿°](https://juejin.cn/post/6845166891711856654)

â¹ï¼š[ä¸‰å¼ å›¾å¯¹æ¯” React ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/60168527)

â¹ï¼š[16.3 æ–°ç‰ˆ react ç”Ÿå‘½å‘¨æœŸ å›¾ç¤º - SegmentFault æ€å¦](https://segmentfault.com/a/1190000020268993)

â¹ï¼š[ï¼ˆâ˜…ï¼‰Hooks ä¸ React ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»](https://juejin.cn/post/6844903901620092941)

â¹ï¼š[ï¼ˆâ˜…ï¼‰å‡½æ•°å¼ç»„ä»¶çš„å´›èµ· - é»¯ç¾½è½»æ‰¬](http://www.ayqy.net/blog/the-rise-of-function-component/)

â¹ï¼š[ï¼ˆâ˜…ï¼‰2019 å¹´ 17 é“é«˜é¢‘ React é¢è¯•é¢˜åŠè¯¦è§£](https://juejin.cn/post/6844903922453200904#heading-3)