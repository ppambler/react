### âœï¸ Tangxt â³ 2021-03-25 ğŸ·ï¸ epic  

# 01-é¡¹ç›®ç»“æ„æ­å»ºã€æ ·å¼å¼•å…¥ã€çŠ¶æ€ç®¡ç†

1ï¼‰ç¯å¢ƒæ­å»º

ç”¨ `create-react-app` åˆ›å»ºé¡¹ç›®

å®‰è£…çš„ä¾èµ–åŒ…ï¼š

- `yarn add react-router-dom`
- `yarn add mobx`
- `yarn add styled-components`

2ï¼‰é¡µé¢ç»“æ„æ­å»º & å•é¡µé¢åº”ç”¨è·¯ç”±

æ–‡æ¡£ï¼š[React Router: Declarative Routing for React.js](https://reactrouter.com/web/guides/quick-start)

é¡µé¢ï¼š

1. Home
2. History
3. About

å…¬å…±ç»„ä»¶ï¼š

- Footer
- Header

ğŸ’¡ï¼šç»„ä»¶ä¸­éœ€è¦ç”¨åˆ°å›¾ç‰‡ï¼Œé‚£æˆ‘åº”è¯¥æŠŠè¿™å›¾ç‰‡æ”¾ç½®åˆ°é‚£ä¸ªç›®å½•å¥½å‘¢ï¼Ÿ

æ ¹ç›®å½•ç»“æ„ï¼š

```
.
â”œâ”€â”€ build/      : å­˜æ”¾é¡¹ç›®è¢« webpack å¤„ç†åç”Ÿæˆçš„æ–‡ä»¶ï¼›
â”œâ”€â”€ config/     : å­˜æ”¾çš„æ˜¯é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼›
â”œâ”€â”€ node_modules/   : å­˜æ”¾ npm å®‰è£…çš„å·¥å…·åŒ… æˆ– æ¨¡å—ï¼›
â”œâ”€â”€ public/     : é™æ€èµ„æºï¼Œè¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ä¼šè¢« webpack å¤„ç†ï¼Œå®ƒä»¬ä¼šè¢«æ‹·è´åˆ° build/ æ–‡ä»¶å¤¹ä¸‹ï¼›
â”œâ”€â”€ scripts/    : ä¸é¡¹ç›®çš„æ„å»ºã€æ‰“åŒ… æˆ– æœåŠ¡ ç›¸å…³çš„è„šæœ¬ï¼›
â””â”€â”€ src/        : é¡¹ç›®çš„æºä»£ç åŠèµ„æºï¼›
```

`src` ç›®å½•ç»“æ„ï¼š

```
src/
â”œâ”€â”€ app/    : å­˜æ”¾é¡¹ç›®ä¸šåŠ¡ä»£ç ï¼›
â”œâ”€â”€ common/     : å­˜æ”¾é¡¹ç›®å…±ç”¨çš„èµ„æºï¼Œå¦‚ï¼šå¸¸ç”¨çš„å›¾ç‰‡ã€å›¾æ ‡ã€å…±ç”¨çš„ç»„ä»¶ã€å…±ç”¨çš„æ ·å¼ã€å¸¸é‡æ–‡ä»¶ç­‰ç­‰ï¼›
â”‚   â”œâ”€â”€ assets/     : å­˜æ”¾é¡¹ç›®å…±ç”¨çš„ä»£ç ä»¥å¤–çš„èµ„æºï¼Œå¦‚ï¼šå›¾ç‰‡ã€å›¾æ ‡ã€è§†é¢‘ ç­‰ï¼›
â”‚   â”œâ”€â”€ component/      : å­˜æ”¾é¡¹ç›®å…±ç”¨çš„ç»„ä»¶ï¼Œå¦‚ï¼šå°è£…çš„å¯¼èˆªæ¡ã€é€‰é¡¹å¡ç­‰ç­‰ï¼›  å¤‡æ³¨ï¼šè¿™é‡Œçš„å­˜æ”¾çš„ç»„ä»¶åº”è¯¥éƒ½æ˜¯å±•ç¤ºç»„ä»¶ï¼›
â”‚   â”œâ”€â”€ constant.less       : å­˜æ”¾ Less çš„å¸¸é‡ï¼›
â”‚   â””â”€â”€ constant.js     : å­˜æ”¾ js çš„å¸¸é‡ï¼›
â”œâ”€â”€ index.jsx       : webpack çš„å…¥å£æ–‡ä»¶ï¼›
â””â”€â”€ registerServiceWorker.js
```

æˆ‘æ”¾ç½®åœ¨ `common/assets/` é‡Œè¾¹

â¹ï¼š[React é¡¹ç›®è§„èŒƒ - ç®€ä¹¦](https://www.jianshu.com/p/7f81913d1298)

ğŸ’¡ï¼šåœ¨ React ä¸­ï¼Œå¦‚ä½•ç”¨`@`è®¿é—®`src`ï¼Ÿ

1. æ‰¾åˆ°`node_modules/react-scripts/config/webpack.config.js` -> VS Code å¿«æ·é”® `Ctrl + p`
2. æ‰¾åˆ° `alias`ï¼Œæ·»åŠ ä»£ç ï¼š`'@': path.resolve('src'),`

å¦‚ä½•åœ¨è¾“å…¥`@`æ—¶ï¼Œè®© VS Code æç¤ºè·¯å¾„ï¼Ÿ

1. å®‰è£…æ’ä»¶ï¼š`path-intellisense`
2. é…ç½®æ’ä»¶ï¼š`"path-intellisense.mappings": {"@": "${workspaceRoot}/src" }`

â¹ï¼š[vs code ä¸­è·¯å¾„åˆ«åï¼ˆ@ï¼‰æç¤ºå’Œè½¬å®šä¹‰ç­‰é—®é¢˜ã€‚ - ç®€ä¹¦](https://www.jianshu.com/p/1798d57ecdab)

ğŸ’¡ï¼šå¦‚ä½•ç‚¹å‡»è·¯å¾„è·³åˆ°å›¾ç‰‡å¤„ï¼Ÿ

![å›¾ç‰‡ä½ç½®](assets/img/2021-03-25-20-45-11.png)

ä¸è¦`@`æ˜¯å¯ä»¥çš„ï¼š

![@ä¸è¦](assets/img/2021-03-25-20-49-21.png)

3ï¼‰styled-components æ§åˆ¶æ ·å¼

- æ–‡æ¡£ï¼š[styled-components](https://styled-components.com/)
- [styled-components åŸºæœ¬ç”¨æ³• - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/347651032)
- å®‰è£…è¯­æ³•æç¤ºæ’ä»¶ï¼š`vscode-styled-components`

1ã€Footer

![Footer](assets/img/2021-03-25-21-06-56.png)

- `styled.footer`å³`footer`å…ƒç´ çš„æ ·å¼
- `Footer`çš„ç±»å‹æ˜¯ï¼š`Symbol(react.forward_ref)`
- `Component`çš„ç±»å‹æ˜¯ï¼š`Symbol(react.element)` -> ç»“åˆ`Footer` -> è¿”å›ä¸€ä¸ªå¸¦æœ‰æ ·å¼çš„ React å…ƒç´ ï¼

ğŸ’¡ï¼šæŠŠ`index.js`å¼•å…¥çš„`index.css`ç»™åˆ äº†ï¼Œä¸ºå•¥è¦åˆ ï¼Ÿ

è®©`App.css`æ§åˆ¶æ•´ä¸ªé¡µé¢çš„å…¨å±€æ ·å¼ï¼

ğŸ’¡ï¼šä¸ºå•¥ `App.css` æœ‰ä¸ª`#root`ç”¨äºæ§åˆ¶æ•´ä¸ªåº”ç”¨çš„å¸ƒå±€ï¼Ÿ

å¦‚æœ`App.js`ï¼Œè¿”å›é»˜è®¤çš„`<div className="App"></div>`ï¼Œé‚£ä¹ˆé¡µé¢å°±å¤šäº†ä¸€å±‚`.App`äº†ï¼Œå³`div#root > div.App` è¿™æ ·ç»“æ„ï¼

æ‰€ä»¥æˆ‘ä»¬æ”¹äº†ä¸€ä¸‹`App.js`ï¼Œè®©å®ƒè¿”å›çš„æ˜¯`<></>`ï¼Œè¿™æ ·å°±æ²¡æœ‰å¤šä½™çš„`div`åŒ…è£¹å…ƒç´ äº†ï¼

2ã€Header

``` jsx
import React from "react";
import LogoUrl from "@/common/assets/logo.svg";
import { NavLink } from "react-router-dom";
import styled from "styled-components";

const Header = styled.header`
  display: flex;
  align-items: center;
  padding: 10px 100px;
  background-color: #02101f;
`;

const Logo = styled.img`
  height: 30px;
`;

const StyledLink = styled(NavLink)`
  margin-left: 30px;
  color: #fff;
  &.active {
    border-bottom: 1px solid #fff;
  }
`;

function Component() {
  return (
    <Header>
      <Logo src={LogoUrl} alt="" />
      <nav>
        <StyledLink to="/" activeClassName="active" exact>
          é¦–é¡µ
        </StyledLink>
        <StyledLink to="/history" activeClassName="active">
          ä¸Šä¼ å†å²
        </StyledLink>
        <StyledLink to="/about" activeClassName="active">
          å…³äºæˆ‘
        </StyledLink>
      </nav>
    </Header>
  );
}

export default Component;
```

ğŸ’¡ï¼š`styled(NavLink)`è¿™æ˜¯ä»€ä¹ˆè¯­æ³•ï¼Ÿ

![ä¼ å‚æ•°](assets/img/2021-03-25-22-38-57.png)

è¿™æ˜¯åœ¨å¯¹`NavLink`ç»„ä»¶è¿›è¡Œ**äºŒæ¬¡æ ·å¼ä¿®é¥°** -> `NavLink`æ˜¯ä¸ª`a`å…ƒç´ ï¼Œç›¸å½“äºå¾€ `a` å…ƒç´ ä¸ŠåŠ äº†å…¶å®ƒ`class`ï¼

![äºŒæ¬¡æ ·å¼ä¿®é¥°](assets/img/2021-03-25-23-55-59.png)

> `class` é™„åŠ åˆ° React å…ƒç´ çš„æ ¹å…ƒç´ ä¸Š

å…¶å®è¯´ç™½äº†ï¼Œå¯¹äºè‡ªå®šä¹‰ç»„ä»¶æ ‡ç­¾ï¼Œæˆ‘ä»¬å°±å¾—ç”¨æ‹¬å·ï¼Œå¦‚æœä½ ä¸ç”¨æ‹¬å·çš„è¯ï¼Œæ˜¯æ— æ³•è¯†åˆ«è¿™æ˜¯ä¸€ä¸ª HTML å…ƒç´ çš„ï¼

â¹ï¼š[React ä¸­ä½¿ç”¨ styled-components çš„åŸºç¡€ä½¿ç”¨ - ä¸€åªèœé¸Ÿæ”»åŸç‹®å•Š - åšå®¢å›­](https://www.cnblogs.com/suihang/p/9971890.html)

â¹ï¼š[styled-components ä½¿ç”¨æ–¹æ³• - SegmentFault æ€å¦](https://segmentfault.com/a/1190000017155008)

ğŸ’¡ï¼š`react-router-dom`çš„`NavLink`å’Œ`Link`æœ‰å•¥åŒºåˆ«ï¼Ÿ

`<NavLink>`æ˜¯`<Link>`çš„ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬ï¼Œä¼šåœ¨åŒ¹é…ä¸Šå½“å‰çš„ url çš„æ—¶å€™**ç»™å·²ç»æ¸²æŸ“çš„å…ƒç´ æ·»åŠ å‚æ•°**ï¼Œè¯¥ç»„ä»¶çš„å±æ€§æœ‰ï¼š

* activeClassName(string)ï¼šè®¾ç½®é€‰ä¸­æ ·å¼ï¼Œé»˜è®¤å€¼ä¸º `active`
* activeStyle(object)ï¼šå½“å…ƒç´ è¢«é€‰ä¸­æ—¶ï¼Œä¸ºæ­¤å…ƒç´ æ·»åŠ æ ·å¼
* exact(bool)ï¼šä¸º `true` æ—¶ï¼Œåªæœ‰å½“è·¯å¾„å®Œå…¨åŒ¹é…æ—¶ï¼Œ `class` å’Œ `style` æ‰ä¼šè¢«åº”ç”¨
* strict(bool)ï¼šä¸º `true` æ—¶ï¼Œåœ¨ç¡®å®šä¸ºä½ç½®æ˜¯å¦ä¸å½“å‰ URL åŒ¹é…æ—¶ï¼Œå°†è€ƒè™‘ä½ç½® pathname åçš„æ–œçº¿
* isActive(func)ï¼š åˆ¤æ–­é“¾æ¥æ˜¯å¦æ¿€æ´»çš„é¢å¤–é€»è¾‘çš„åŠŸèƒ½

![NavLink](assets/img/2021-03-25-23-19-15.png)

ç®€å•æ¥è¯´ï¼š

![ç®€å•æ¥è¯´](assets/img/2021-03-25-23-22-56.png)

â¹ï¼š[React Router ä¸­ Link å’Œ NavLink çš„å­¦ä¹ æ€»ç»“_å†°é›ªä¸ºèçš„åšå®¢-CSDN åšå®¢](https://blog.csdn.net/lhjuejiang/article/details/80366839)

â¹ï¼š[javascript - React Router v4 `<NavLink>` vs `<Link>` benefits - Stack Overflow](https://stackoverflow.com/questions/47338077/react-router-v4-navlink-vs-link-benefits)

â¹ï¼š[active styles using NavLink - React router beginners guide - Reactgo](https://reactgo.com/reactrouter/navlink/)

4ï¼‰åŠ¨æ€åŠ è½½ç»„ä»¶

é¡µé¢ä¸€æ‰“å¼€ï¼Œä¸è¦ä¸€å£æ°”åŠ è½½æ‰€æœ‰ä»£ç ï¼Œå…ˆè½½å…¥æ¯”è¾ƒé‡è¦çš„ JSï¼Œä¹‹åè§†ç”¨æˆ·æ“ä½œæƒ…å†µï¼Œå†è½½å…¥æ¬¡è¦çš„ JS

ä¸ç„¶ï¼Œéšç€ä»£ç é‡çš„å¢åŠ ï¼Œé¡µé¢è½½å…¥æ—¶é—´ä¹Ÿä¼šéšç€æ‹‰é•¿ï¼Œæœ€åå½±å“ç”¨æˆ·ä½“éªŒ

React Suspense & React Lazy ä¸º **16.6** çš„ç‰ˆæœ¬æ‰æœ‰çš„åŠŸèƒ½ï¼Œè€Œä¸”ç›®å‰è¿™ä¸¤ä¸œè¥¿æ— æ³•åœ¨ SSR åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œå¦‚æœä½ åœ¨æ­¤åœºæ™¯ä¸‹ï¼ŒçœŸå¾—æœ‰ä»£ç åˆ‡å‰²çš„éœ€æ±‚ï¼Œé‚£å°±å¿…é¡»ä½¿ç”¨ã€Œ Loadable Componentsã€äº†ï¼

- Lazyï¼šåŠ¨æ€è½½å…¥ jsï¼Œå¯ä»¥å°†ç¨‹å¼ç åˆ†å‰²ï¼Œéœ€è¦ç”¨åˆ°æ—¶å†ç”¨ `import` è½½å…¥
- Suspenseï¼šå»¶è¿Ÿè½½å…¥ `component` ä¼šè¢« `Suspense` åŒ…è¦† ï¼Œå‡å¦‚ `component` è¿˜æ²¡è½½å…¥å®Œæˆï¼Œ å°±èƒ½å¤Ÿé€è¿‡ `fallback` æ˜¾ç¤ºä¸€äº›æç¤ºè®¯æ¯ï¼Œ**å¿…é¡»æ­é… Lazy ä½¿ç”¨**ï¼Œå¦‚æœåªæœ‰å†™ Lazy æ²¡æœ‰ Suspense çš„è¯å°±ä¼šæŠ¥é”™ï¼Œå¦å¤–ï¼Œ`Suspense` å¯ä»¥åŒ…è¦†å¤šä¸ª lazy component

ä»£ç ï¼š

![ä»£ç ](assets/img/2021-03-26-00-46-27.png)

æ•ˆæœï¼š

![æ•ˆæœ](assets/img/2021-03-26-00-49-56.png)

â¹ï¼š[åˆ©ç”¨ React Suspense & React Lazy ä¾†å„ªåŒ–è¼‰å…¥é€Ÿåº¦ - Coding Hot Pot - Medium](https://medium.com/coding-hot-pot/%E5%88%A9%E7%94%A8react-suspense-react-lazy%E4%BE%86%E5%84%AA%E5%8C%96%E8%BC%89%E5%85%A5%E9%80%9F%E5%BA%A6-befe89c1454f)

â¹ï¼š[è¿™å°±æ˜¯ä½ æ—¥æ€å¤œæƒ³çš„ React åŸç”ŸåŠ¨æ€åŠ è½½ - æ”¿é‡‡äº‘å‰ç«¯å›¢é˜Ÿ](https://www.zoo.team/article/react-lazy-suspense)

5ï¼‰mobx å®ç°çŠ¶æ€ç®¡ç†

ğŸ’¡ï¼š`createContext`ã€`useContext`ï¼Ÿ

é’ˆå¯¹å‡½æ•°ç»„ä»¶ -> æå±€éƒ¨çš„å…¨å±€æ•°æ®çš„ï¼

â¹ï¼š[ç²¾è¯»ã€ŠFunction Component å…¥é—¨ã€‹](https://juejin.cn/post/6844903854174109703#heading-12)

â¹ï¼š[React Hook ä¸­ createContext & useContext è·¨ç»„ä»¶é€ä¼ ä¸Šä¸‹æ–‡ä¸æ€§èƒ½ä¼˜åŒ– - Postbird - çŒ«æ—¢å¾å‘½](http://www.ptbird.cn/react-createContex-useContext.html)

ğŸ’¡ï¼šç”¨ cra åˆ›å»ºå‡ºæ¥çš„é¡¹ç›®é»˜è®¤ä¸æ”¯æŒè£…é¥°å™¨è¯­æ³•ï¼Ÿ

å¦‚ä½•è§£å†³ï¼Ÿ -> ç”¨ä¸¤ç§å§¿åŠ¿ï¼š

å§¿åŠ¿ 1ï¼š

ä½¿ç”¨ `eject` è¿™ä¸ªå‘½ä»¤ï¼Œ`yarn eject`åï¼Œ`create-react-app`ä¼šç”Ÿæˆæ‰€æœ‰é…ç½®æ–‡ä»¶ -> æ ¹æ®è¿™ä¸ªé…ç½®ï¼Œå»é…ç½®æ”¯æŒè£…é¥°å™¨çš„æ’ä»¶å³å¯ï¼

ç¼ºç‚¹ï¼šè‹¥ cra å‡çº§ï¼Œé‚£ç”Ÿæˆçš„é…ç½®å¯èƒ½ä¼šå’Œæ–°ç‰ˆä¸å…¼å®¹ -> è¯¥ç”Ÿæˆçš„é…ç½®å¯æ— æ³•è‡ªåŠ¨éš cra å‡çº§

å§¿åŠ¿ 2ï¼š

é€šè¿‡ react-app-rewired åŠ¨æ€ä¿®æ”¹ï¼Œä¿®æ”¹ npm ç­‰è„šæœ¬ï¼Œè®©å…¶ä» react-app-rewired å¯åŠ¨ã€‚

åšæ³•ï¼š

step1ï¼šå®‰è£…ä¾èµ–

``` bash
yarn add -D customize-cra react-app-rewired @babel/plugin-proposal-decorators
```

step2ï¼šåœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»º `config-overrides.js`

``` js
const {
  override,
  addDecoratorsLegacy,
  disableEsLint,
  overrideDevServer,
  watchAll,
} = require("customize-cra");

module.exports = {
  webpack: override(addDecoratorsLegacy(), disableEsLint()),
  devServer: overrideDevServer(
    // dev server plugin
    watchAll()
  ),
};
```

step3ï¼šä¿®æ”¹ `package.json` æ–‡ä»¶

``` json
{
  "scripts": {
    "start": "react-app-rewired start",
    "build": "react-app-rewired build",
    "test": "react-app-rewired test",
    "eject": "react-app-rewired eject"
  }
}
```

é‡æ–°å¯åŠ¨é¡¹ç›® -> `yarn start` -> æ²¡æœ‰æŠ¥é”™äº†ï¼ä¸è¿‡åŸå…ˆä½¿ç”¨`@`è¿™æ ·çš„è·¯å¾„åˆ™å¤±æ•ˆäº†â€¦â€¦

â¹ï¼š[SyntaxError: Support for the experimental syntax 'decorators-legacy' isn't currently enabled_some1204çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/some1204/article/details/105752622)

---




