### âœï¸ Tangxt â³ 2021-03-13 ğŸ·ï¸ React

# 02-React ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶

## â˜…å…ƒç´  vs ç»„ä»¶

1ï¼‰å…ƒç´ ä¸ç»„ä»¶

![å…ƒç´ ä¸ç»„ä»¶](assets/img/2021-03-15-11-10-46.png)

2ï¼‰ä»€ä¹ˆæ˜¯ç»„ä»¶ï¼Ÿ

![ç»„ä»¶](assets/img/2021-03-15-11-13-12.png)

- å°±ç›®å‰çš„ React ç‰ˆæœ¬è€Œè¨€ï¼Œä¸€ä¸ªè¿”å›äº† React å…ƒç´ çš„**å‡½æ•°**å°±æ˜¯**ç»„ä»¶**
- è€Œ Vue -> ä¸€ä¸ªæ„é€ é€‰é¡¹å³ä¸€ä¸ªç»„ä»¶

3ï¼‰React ä¸¤ç§ç»„ä»¶

å‡½æ•°ç»„ä»¶ï¼š

![å‡½æ•°ç»„ä»¶](assets/img/2021-03-15-11-18-29.png)

ç±»ç»„ä»¶ï¼š

![ç±»ç»„ä»¶](assets/img/2021-03-15-11-20-45.png)

## â˜…æ ‡ç­¾ä¼šè¢«ç¿»è¯‘ä¸º `React.createElement`

1ï¼‰Welcome æ ‡ç­¾

![Welcome](assets/img/2021-03-16-11-54-37.png)

å¦‚ï¼š

![babel-online](assets/img/2021-03-16-11-57-59.png)

2ï¼‰`React.createElement` çš„é€»è¾‘

![react å…ƒç´ ](assets/img/2021-03-16-12-03-39.png)

é¢˜å¤–è¯ï¼šå†™ç±»ç»„ä»¶æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œå› ä¸ºæ¯æ¬¡ä½ éƒ½å¾—å†™ä¸€äº›å¾ˆå›ºå®šçš„ä¸œè¥¿ï¼š

![ç±»ç»„ä»¶](assets/img/2021-03-16-12-11-43.png)

## â˜…å°è¯•ç‰›åˆ€ï¼Œè¯·åŠ¨æ‰‹å°è¯•

éœ€æ±‚ï¼š

1. div -> çˆ¸çˆ¸ -> `Father`ç»„ä»¶
   1. div -> å„¿å­ -> `Son`ç»„ä»¶
      1. button -> +1 -> n+1
      2. span -> n
      3. div -> å­™å­ -> `Grandson`ç»„ä»¶
         1. button -> +1 -> n+1
         2. span -> n

å®ç°ï¼š

``` jsx
import React from "react";
import ReactDOM from "react-dom";

import "./styles.css";

function App() {
  return (
    <div className="App">
      çˆ¸çˆ¸
      <Son />
    </div>
  );
}

// å„¿å­ç»„ä»¶
class Son extends React.Component {
  constructor() {
    super();
    this.state = {
      n: 0
    };
  }
  add() {
    // this.state.n += 1 ä¸ºä»€ä¹ˆä¸è¡Œ
    this.setState({ n: this.state.n + 1 });
  }
  render() {
    return (
      <div className="Son">
        å„¿å­ n: {this.state.n}
        <button onClick={() => this.add()}>+1</button>
        <Grandson />
      </div>
    );
  }
}

// å­™å­ç»„ä»¶
const Grandson = () => {
  const [n, setN] = React.useState(0);
  return (
    <div className="Grandson">
      å­™å­ n:{n}
      <button onClick={() => setN(n + 1)}>+1</button>
    </div>
  );
};

//è·å–é¡µé¢ä¸Šéœ€è¦æ¸²æŸ“çš„ä½ç½®
const rootElement = document.getElementById("root");
ReactDOM.render(<App />, rootElement);
```

è§£æï¼š

App ç»„ä»¶ï¼š

![App ç»„ä»¶](assets/img/2021-03-16-13-20-42.png)

Son ç»„ä»¶ï¼š

![Son ç»„ä»¶](assets/img/2021-03-16-13-23-02.png)

Grandson ç»„ä»¶ï¼š

![å­™å­ç»„ä»¶](assets/img/2021-03-16-13-24-30.png)

Grandson çš„åŸç†ï¼š

`0` å°±æ˜¯ `state` çš„åˆå§‹å€¼

è¿™è¡Œä»£ç ï¼š

``` js
const [n, setN] = React.useState(0)
```

ç­‰ä»·äºï¼š

``` js
const array = React.useState(0)
const n = array[0]
const setN = array[1]
```

æˆ‘ä»¬ç”¨äº†ææ„å†™æ³•ï¼šå£°æ˜ä¸€ä¸ª`state`åˆå§‹å€¼ä¸º `0`ï¼Œç”¨ `n` ä»£è¡¨ `0`ï¼Œç”¨ `setN` å»å¯¹ `0` è¿›è¡Œä¿®æ”¹ï¼ˆå¯¹ä¸€ä¸ªå˜é‡çš„è¯»å’Œå†™æ“ä½œï¼‰

æ³¨æ„ï¼š

> `setN`ä¹‹åå¾—åˆ°çš„æ˜¯ä¸€ä¸ªæ–°çš„`n`ï¼Œè€Œä¸æ˜¯æ”¹å˜åŸæœ‰çš„`n`

ğŸ’¡ï¼šä¸ºä»€ä¹ˆ`const`å£°æ˜çš„å˜é‡`n`èƒ½è¢«æ”¹å€¼ï¼Ÿ`setN`åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ

![const å˜é‡](assets/img/2021-03-16-13-47-09.png)

â¹ï¼š[ä¸ºä»€ä¹ˆ useState å¯ä»¥ä½¿ç”¨ const è§£æ„èµ‹å€¼ï¼Ÿ_é«˜æ¡¥é“ä»”çš„åšå®¢-CSDN åšå®¢](https://blog.csdn.net/weixin_45221036/article/details/108581908)

â¹ï¼š[useState çš„åŸç†åŠæ¨¡æ‹Ÿå®ç° â€”â€” React Hooks ç³»åˆ—ï¼ˆä¸€ï¼‰ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/100714485)

## â˜…ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ä½¿ç”¨ `props`

1ï¼‰æ·»åŠ  propsï¼ˆå¤–éƒ¨æ•°æ®ï¼‰

![props](assets/img/2021-03-16-17-20-18.png)

``` jsx
import React from "react";
import ReactDOM from "react-dom";

import "./styles.css";

function App() {
  return (
    <div className="App">
      çˆ¸çˆ¸
      <Son messageForSon="å„¿å­ä½ å¥½" />
    </div>
  );
}

class Son extends React.Component {
  render() {
    return (
      <div className="Son">
        æˆ‘æ˜¯å„¿å­ï¼Œæˆ‘çˆ¸å¯¹æˆ‘è¯´ã€Œ{this.props.messageForSon}ã€
        <Grandson messageForGrandson="å­™è´¼ä½ å¥½" />
      </div>
    );
  }
}

const Grandson = props => {
  return (
    <div className="Grandson">
      æˆ‘æ˜¯å­™å­ï¼Œæˆ‘çˆ¸å¯¹æˆ‘è¯´ã€Œ{props.messageForGrandson}ã€
    </div>
  );
};

const rootElement = document.getElementById("root");
ReactDOM.render(<App />, rootElement);
```

æ•ˆæœï¼š

![æ•ˆæœ](assets/img/2021-03-16-17-26-02.png)

è§£æï¼š

ğŸ’¡ï¼šçˆ¸çˆ¸ç»„ä»¶å¦‚ä½•ä¼ æ•°æ®ç»™å„¿å­ï¼Ÿ

ç›´æ¥åœ¨å„¿å­ç»„ä»¶æ ‡ç­¾ä¸Šå†™å±æ€§ï¼š

![å±æ€§](assets/img/2021-03-16-17-24-18.png)

å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£å°±æ˜¯`"xxx"`ï¼Œå¦‚æœæ˜¯å˜é‡ï¼Œé‚£å°±`{xxx}`

ğŸ’¡ï¼šå„¿å­æ€ä¹ˆæ¥æ”¶çˆ¸çˆ¸ä¼ è¿‡æ¥çš„æ•°æ®ï¼Ÿ

ç±»ç»„ä»¶ç›´æ¥ç”¨`this.props.xxx`ï¼š

![ç±»ç»„ä»¶](assets/img/2021-03-16-17-29-44.png)

å‡½æ•°ç»„ä»¶åˆ™æ˜¯ã€Œç¬¬ä¸€ä¸ªå‚æ•°çš„`xxx`ã€ï¼š

![å‡½æ•°ç»„ä»¶](assets/img/2021-03-16-17-32-23.png)

> ä¹Ÿå¯ä»¥ç”¨ææ„è¯­æ³•`{xxx}`

## â˜…ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ä½¿ç”¨ `state`ï¼ˆå†…éƒ¨æ•°æ®ï¼‰

> ä¼ é€’çš„æ˜¯å†…éƒ¨æ•°æ® -> `state` -> éµå®ˆä¸å¯å˜æ•°æ®ç†å¿µï¼

1ï¼‰æ·»åŠ  stateï¼ˆå†…éƒ¨æ•°æ®ï¼‰

![å†…éƒ¨æ•°æ®](assets/img/2021-03-19-18-05-20.png)

> `setState`ä¼šå¼‚æ­¥æ”¹å˜`n`çš„å€¼ï¼Œè€Œ`useState`åˆ™ä¸ä¼šæ”¹å˜`n`çš„å€¼

ä»£ç ï¼š

``` jsx
import React from "react";
import ReactDOM from "react-dom";

import "./styles.css";

function App() {
  return (
    <div className="App">
      çˆ¸çˆ¸
      <Son />
    </div>
  );
}

class Son extends React.Component {
  constructor() {
    super();
    this.state = {
      n: 0
    };
  }
  add() {
    // this.state.n += 1 ä¸ºä»€ä¹ˆä¸è¡Œ
    this.setState({ n: this.state.n + 1 });
  }
  render() {
    return (
      <div className="Son">
        å„¿å­ n: {this.state.n}
        <button onClick={() => this.add()}>+1</button>
        <Grandson />
      </div>
    );
  }
}

const Grandson = () => {
  const [n, setN] = React.useState(0);
  return (
    <div className="Grandson">
      å­™å­ nï¼š{n}
      <button onClick={() => setN(n + 1)}>+1</button>
    </div>
  );
};

const rootElement = document.getElementById("root");
ReactDOM.render(<App />, rootElement);
```

æ•ˆæœï¼š

![æ•ˆæœ](assets/img/2021-03-19-18-10-11.png)

è§£æï¼š

ğŸ’¡ï¼šç±»ç»„ä»¶çš„`state`ï¼Ÿ

![state](assets/img/2021-03-19-18-14-14.png)

è¯è¯´ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥å†™ `this.state.n=1`ï¼Ÿ

![å¼‚æ­¥æ›´æ–°](assets/img/2021-03-19-18-16-49.png)

åœ¨ Vue é‡Œé¢ä¼šç›‘å¬ `data` çš„å˜åŒ–ï¼Œ`data` æ”¹å˜é¡µé¢æ¸²æŸ“åˆ·æ–°ï¼ˆå› ä¸ºå®ƒè®¾ç½®äº† `set` å’Œ `get` çš„æ¥å£ï¼šå“åº”å¼åŸç†ï¼‰

> è¿™ä¸ªè¿‡ç¨‹æ˜¯ç«‹åˆ»çš„å—ï¼Ÿ

è€Œ React åˆ™æ²¡æœ‰ï¼Œ`state`å˜åŒ–æ¸²æŸ“è¦æˆ‘ä»¬å»æ‰‹åŠ¨è®¾ç½®`setState`ï¼Œè€Œæˆ‘ä»¬è¿™æ ·ï¼š

``` js
this.state.n += 1
this.setState(this.state)
```

å…ˆæŠŠ`state`å˜äº†å†`set`ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†éå¸¸ä¸æ¨èè¿™æ ·åšï¼

å› ä¸º React ä¸å»ºè®®ç›´æ¥ä¿®æ”¹ï¼Œè€Œæ˜¯è¦äº§ç”Ÿä¸€ä¸ªæ–°çš„ï¼ˆ**React çš„ä¸å¯å˜æ•°æ®**ï¼‰ï¼Œå¦‚ï¼š

``` js
// set ä¸€ä¸ªæ–°çš„
this.setState({ n: this.state.n + 1 })
```

è¿›ä¸€æ­¥æ¥è¯´ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ç›´æ¥å†™ä¸€ä¸ªå¯¹è±¡ç»™`setState`ï¼Œè€Œæ˜¯å†™ä¸€ä¸ª**å‡½æ•°**ï¼š

![setState](assets/img/2021-03-19-18-24-03.png)

**å‡½æ•°**æ¥æ”¶çš„å‚æ•°æ˜¯**æ—§çš„`state`**ï¼Œç„¶åè¿”å›ä¸€ä¸ª**æ–°çš„`state`**ï¼š

![state](assets/img/2021-03-19-18-27-56.png)

è¯è¯´ï¼Œè¿™ TM æœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿ

å› ä¸ºï¼š**setState æ˜¯å¼‚æ­¥çš„æ›´æ–° UI çš„è¿‡ç¨‹**

å¦‚æœç›´æ¥è¿™æ ·å†™ï¼š

![å¼‚æ­¥æ›´æ–°](assets/img/2021-03-19-18-31-49.png)

æ‰“å° `state`ï¼ˆæƒ³æ‹¿åˆ°æœ€æ–°çš„ `state`ï¼‰

åœ¨è¿™ä¸ªä»£ç é‡Œè¾¹ï¼Œå…ˆæ‰§è¡Œçš„æ˜¯**æ‰“å°è¯­å¥**ï¼Œ`setState`åªæ˜¯ç­‰ç€è¿˜æ²¡é‡æ–°èµ‹å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šä»¥ä¸ºæ­¤æ—¶çš„`state`å°±æ˜¯æœ€æ–°çš„`state`

> çœ‹æˆæ˜¯ç±»ä¼¼`setTimeout()`è¿™æ ·çš„ä¸œè¥¿

æ‰€ä»¥ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨**å‡½æ•°**ï¼Œä¼ é€’çš„æ˜¯æ—§çš„`state`ï¼Œå¯ä»¥è®©æ–°çš„`state`å…ˆèµ‹å€¼æ‰“å°å‡ºæ¥å†`setState`ï¼ˆ**ç›®çš„åªæ˜¯æ‹¿åˆ°/çœ‹åˆ°æœ€æ–°çš„`state`è€Œå·²å‘€**ï¼‰

![æ‹¿åˆ°æ–°å€¼](assets/img/2021-03-19-18-38-21.png)

æ€»ä¹‹ï¼Œæˆ‘ä»¬ç”¨**å‡½æ•°**ï¼Œå°±æ˜¯å¯ä»¥é¿å…ä½ æ··æ·†æ–°çš„`state`å’Œæ—§çš„`state`ï¼ˆæ–°çš„ `n` å’Œ æ—§çš„ `n`ï¼‰

![å¼‚æ­¥æ›´æ–° UI](assets/img/2021-03-19-18-41-08.png)

![ä¸æ¨è](assets/img/2021-03-19-18-41-28.png)

> å‡½æ•°ä¹Ÿæ˜¯å€¼ï¼Œå®ƒå¯ä»¥å»¶è¿Ÿè¿”å›ä¸€ä¸ªå€¼

ğŸ’¡ï¼šå‡½æ•°ç»„ä»¶çš„`state`ï¼Ÿ

å‡½æ•°ç»„ä»¶æ˜¯æ€ä¹ˆä½¿ç”¨`state`çš„ï¼Ÿ -> ä½¿ç”¨`useState`ï¼ˆHooks API æ²¡å•¥ç¥å¥‡çš„ï¼Œä¹Ÿå°±é‚£æ ·â€¦â€¦ï¼‰

è€Œç±»ç»„ä»¶æ˜¯ç›´æ¥å°±æœ‰`setState`äº†ï¼

å‡½æ•°ç»„ä»¶æ˜¯è¦ä» `useState` æ‹¿å‡ºæ¥çš„ï¼ˆ**`useState`å°±ä¸¤ä¸ªæ¥å£è¯»å’Œå†™**ï¼‰

æ•°ç»„çš„ç¬¬ä¸€é¡¹æ˜¯ç”¨æ¥è¯»çš„ï¼Œç¬¬äºŒé¡¹æ˜¯ç”¨æ¥å†™çš„ -> åå­—å¯ä»¥éšä¾¿èµ·

![useState](assets/img/2021-03-19-18-48-15.png)

è®°ä½ï¼š

![setN ä¹Ÿæ˜¯å¼‚æ­¥çš„](assets/img/2021-03-19-18-51-32.png)

`setN` æ°¸è¿œä¸ä¼šæ”¹å˜ nï¼Œè€Œæ˜¯äº§ç”Ÿä¸€ä¸ª**æ–°çš„ n**ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜¯**å¼‚æ­¥çš„**

> æ¯æ¬¡ `+1` éƒ½ä¼šé‡æ–°æ‰§è¡Œä¸€éå‡½æ•°

![å¼‚æ­¥](assets/img/2021-03-19-18-59-39.png)

> `setN`å†…éƒ¨ä¼šå»æ‰§è¡Œ`Grandson`å‡½æ•° -> å¥½å¥‡å®ƒæ˜¯å¦‚ä½•çœç•¥è¿™ä¸ª`const [n, setN] = React.useState(0)`çš„ï¼Ÿ -> å¤§æ¦‚æ˜¯`setN`ä¼šæŠŠæ–°å€¼`n+1`äº¤ç»™å…¨å±€å˜é‡`_state`ï¼ˆæ•°ç»„ï¼‰ï¼Œç„¶å`ReactDOM.render(<Grandson />,...)`ï¼Œæ‰€ä»¥æ­¤æ—¶ä¼šå»æ‰§è¡Œ`Grandson`å‡½æ•° -> `useState`å†æ¬¡æ‰§è¡Œï¼Œä¼šå»åˆ¤æ–­`n`æ˜¯å¦è¿˜ç”¨åˆå§‹å€¼ï¼Œæ˜¾ç„¶ä¸ç”¨åˆå§‹å€¼ï¼
> 
> [useState çš„åŸç†åŠæ¨¡æ‹Ÿå®ç° â€”â€” React Hooks ç³»åˆ—ï¼ˆä¸€ï¼‰ - Caijialinxx](https://caijialinxx.github.io/2019/12/23/hooks-useState/)

å¥½å¥‡æ€ªçš„ç»“è®ºï¼š

ç±»çš„ `setState` ä¼šç­‰ä¸€ä¼šå†æ”¹å˜ nï¼Œè€Œå‡½æ•°ç»„ä»¶çš„ `setN` æ˜¯æ°¸è¿œéƒ½ä¸ä¼šæ”¹å˜ nï¼ˆå¯¹æ¯” Vueï¼ŒVue çœŸæ˜¯å¤ªå¥½ç†è§£äº†ï¼‰

æ³¨æ„äº‹é¡¹ï¼š

![æ³¨æ„äº‹é¡¹](assets/img/2021-03-19-19-03-58.png)

## â˜… Vue/React ç¼–ç¨‹æ¨¡å‹

